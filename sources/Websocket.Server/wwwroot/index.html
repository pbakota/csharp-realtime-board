<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Websockets</title>
</head>

<body>
    <h1>Websocket server</h1>
    <script src="https://cdn.jsdelivr.net/npm/@stomp/stompjs@5.0.0/bundles/stomp.umd.min.js"></script>
    <script>
        const client = new StompJs.Client({
            brokerURL: 'ws://playbox:15674/ws',
            // brokerURL: 'ws://localhost:5000/websocket',
            connectHeaders: {
                login: 'guest',
                passcode: 'guest',
            },
            debug: (msg) => {
                console.log(msg);
            }
        });

        client.onConnect = (frame) => {
            console.log('Websocket connected');

            client.subscribe('/topic/test', message =>
                console.log(`Received: ${message.body}`)
            );

            client.publish({
                destination: '/topic/test',
                body: 'HELLO',
                skipContentLengthHeader: true,
            });
        };

        client.onStompError = (frame) => {
            console.log('Broker reported error: ' + frame.headers['message']);
            console.log('Additional details: ' + frame.body);
        };

        client.activate();

    </script>
</body>

</html>